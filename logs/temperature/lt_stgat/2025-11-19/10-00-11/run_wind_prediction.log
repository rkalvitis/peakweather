[2025-11-19 10:00:12,062][tsl][INFO] - 
**** Experiment config ****
experiment_name: peakweather_temperature
mlflow_tracking_uri: null
workers: 4
num_threads: 4
epochs: 200
patience: 50
batch_size: 32
train_batches: 300
grad_clip_val: 5
loss_fn: mae
sampling:
  mc_samples_train: 16
  mc_samples_eval: 11
  mc_samples_test: 100
optimizer:
  name: Adam
  hparams:
    lr: 0.001
nwp_test_set: false
dataset:
  name: temperature
  hparams:
    root: ./data/PeakWeather
    target_channels:
    - temperature
    covariate_channels: other
    freq: h
    station_type: meteo_station
    extended_nwp_vars:
    - ew_wind
    - humidity
    - nw_wind
    - precipitation
    - pressure
    - sunshine
    - temperature
    - wind_gust
    extended_topo_vars:
    - ASPECT_10000M_SIGRATIO1
    - ASPECT_2000M_SIGRATIO1
    - DEM
    - SLOPE_10000M_SIGRATIO1
    - SLOPE_2000M_SIGRATIO1
    - SN_DERIVATIVE_10000M_SIGRATIO1
    - SN_DERIVATIVE_2000M_SIGRATIO1
    - STD_10000M
    - STD_2000M
    - TPI_10000M
    - TPI_2000M
    - WE_DERIVATIVE_10000M_SIGRATIO1
    - WE_DERIVATIVE_2000M_SIGRATIO1
  zerowind: 1.0
  splitting:
    first_val_ts:
    - 2024
    - 1
    - 1
    first_test_ts:
    - 2024
    - 4
    - 1
  connectivity:
    threshold: 0.7
    theta: null
    include_self: false
    knn: 8
    layout: csr
  covariates:
    year: true
    day: true
    weekday: true
    mask: true
    u_mask: true
    v: true
  static_attributes:
  - latitude
  - longitude
  - station_height
  - ASPECT_10000M_SIGRATIO1
  - ASPECT_2000M_SIGRATIO1
  - dem
  - SLOPE_10000M_SIGRATIO1
  - SLOPE_2000M_SIGRATIO1
  - SN_DERIVATIVE_10000M_SIGRATIO1
  - SN_DERIVATIVE_2000M_SIGRATIO1
  - STD_10000M
  - STD_2000M
  - TPI_10000M
  - TPI_2000M
  - WE_DERIVATIVE_10000M_SIGRATIO1
  - WE_DERIVATIVE_2000M_SIGRATIO1
window: 168
horizon: 24
stride: 1
scaler:
  method: Standard
  axis: graph
  scale_target: true
model:
  name: lt_stgat
  hparams:
    transformer_d_model: 128
    transformer_heads: 4
    transformer_layers: 2
    transformer_ff_size: 256
    dropout: 0.5
    segment_length: 24
    max_segments: 32
    segments_per_day: 24
    days_per_cycle: 7
    long_term_kernel_sizes:
    - 3
    - 5
    - 7
    - 9
    long_term_dilations:
    - 1
    - 2
    - 3
    - 4
    short_window: 24
    short_hidden_size: 96
    short_graph_layers: 2
    short_time_layers: 1
    graph_activation: relu
    graph_norm: sym
    graph_root_weight: true
    graph_cached: false
lr_scheduler:
  name: MultiStepLR
  hparams:
    gamma: 0.3
    milestones:
    - 40
    - 60
    - 100
run:
  seed: 557357675
  dir: /home/jupyter/peakweather/logs/temperature/lt_stgat/2025-11-19/10-00-11
  name: 2025-11-19_10-00-12_557357675

[2025-11-19 10:00:44,597][tsl][INFO] - Fit and set scaler for target: StandardScaler(bias=(1, 1, 1), scale=(1, 1, 1))
[2025-11-19 10:00:46,802][tsl][WARNING] - Only args ['x', 'u', 'edge_index'] are forwarded to the model (TransformerSpatioTemporalGAT).
[2025-11-19 12:11:09,710][tsl][INFO] - 1.554360270500183
